This is based on 6.14.0-1012-aws arm64 kernel
Use ebpf to insert a kprobe to nfnetlink_rcv_batch+0x2f4 and print skb->len in a while loop in nfnetlink_rcv_batch

Disassembly code:
/build/linux-aws-6.14-Uo7rAK/linux-aws-6.14-6.14.0/net/netfilter/nfnetlink.c: 562
0xffffd5d585a1e33c <nfnetlink_rcv_batch+0x2f4>: ldr     w2, [x20, #112]
/build/linux-aws-6.14-Uo7rAK/linux-aws-6.14-6.14.0/net/netfilter/nfnetlink.c: 561
0xffffd5d585a1e340 <nfnetlink_rcv_batch+0x2f8>: add     w1, w1, #0x3

561                 msglen = NLMSG_ALIGN(nlh->nlmsg_len);
562                 if (msglen > skb->len)
563                         msglen = skb->len;
564                 skb_pull(skb, msglen);

skb pointer is stored in x20

vmlinux.h is generated by running the following command on 6.14.0-1012-aws system:
bpftool btf dump file /sys/kernel/btf/vmlinux format c > vmlinux.h

Install dependencies:
sudo apt install build-essential libbpf-dev clang

Due to a bug on Ubuntu 24.04, linux-tools-6.14.0-xxx doesn't have bpftool
You have to install linux-tools-6.8.0-85-generic and use bpftool from this package
